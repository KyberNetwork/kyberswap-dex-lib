package decode

import (
	"encoding/json"
	"fmt"
	"testing"

	"github.com/stretchr/testify/assert"
)

func TestDecoder_Decode(t *testing.T) {
	t.Parallel()

	testCases := []struct {
		name string
		data string
	}{
		{
			name: "it should decode normal successfully",
			data: "0xe21fd0e900000000000000000000000000000000000000000000000000000000000000200000000000000000000000001d5702c6d7eb30e42a8c94b8db7ea2e8444a37fd000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000006e000000000000000000000000000000000000000000000000000000000000009200000000000000000000000000000000000000000000000000000000000000620000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000008fd0195469b51a935dc3c48617ced6b400e38c9c000000000000000000000000c2132d05d31c914a87c6611c10748aeb04b58e8f000000000000000000000000000000000000000000000000000000000001edb40000000000000000000000006131b5fae19ea4f9d964eac0408e4408b66337b50000000000000000000000000000000000000000000000000000000063bcca8200000000000000000000000000000000000000000000000000000000000005e0000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000001e0000000000000000000000000000000000000000000000000000000000000034000000000000000000000000000000000000000000000000000000000000000408a5da90f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001200000000000000000000000001d5702c6d7eb30e42a8c94b8db7ea2e8444a37fd000000000000000000000000bee74494f276822b8f2e1e6ecb584b82f74427c80000000000000000000000008fd0195469b51a935dc3c48617ced6b400e38c9c0000000000000000000000002791bca1f2de4661ed88a30c99a7a9449aa84174000000000000000000000000000000000000000000000002700829669261c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000dfaf9584f5d229a9dbe5978523317820a8897c5a0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000409e8aa9350000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000001d5702c6d7eb30e42a8c94b8db7ea2e8444a37fd0000000000000000000000003d0acd52ee4a9271a0ffe75f9b91049152bac64b0000000000000000000000002791bca1f2de4661ed88a30c99a7a9449aa84174000000000000000000000000c3c7d422809852031b44ab29eec9f1eff2a58756000000000000000000000000000000000000000000000000000000000001cef300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000409e8aa9350000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000001d5702c6d7eb30e42a8c94b8db7ea2e8444a37fd0000000000000000000000007369ad0fad7e20dd126aa8630513b61e1070a5ee000000000000000000000000c3c7d422809852031b44ab29eec9f1eff2a58756000000000000000000000000c2132d05d31c914a87c6611c10748aeb04b58e8f00000000000000000000000000000000000000000000000000e12b67834118d400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008fd0195469b51a935dc3c48617ced6b400e38c9c000000000000000000000000c2132d05d31c914a87c6611c10748aeb04b58e8f000000000000000000000000000000000000000000000000000000000000016000000000000000000000000000000000000000000000000000000000000001a000000000000000000000000000000000000000000000000000000000000001e00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000ecf0e6eae1db5f52f9114885ef3eb4e5e323e90c000000000000000000000000000000000000000000000002700829669261c000000000000000000000000000000000000000000000000000000000000001edb40000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000000000000000000000000000000000000000010000000000000000000000001d5702c6d7eb30e42a8c94b8db7ea2e8444a37fd0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000002700829669261c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001db7b22536f75726365223a22222c22416d6f756e74496e555344223a2230222c22416d6f756e744f7574555344223a22302e3132373031393439313932222c22526566657272616c223a22222c22466c616773223a332c22496e74656772697479496e666f223a7b224b65794944223a2231222c225369676e6174757265223a224467664c675878393369554e4e4a316f614239616e577352396835594c794c54364f39593557394632636e794b476e6e6e2f394f51566f3976632f5642493839583076764e626c6737416b466b2b4c39663376637168383479366c346c37627236786673426631396f484f662f416e4a3468544e337a62656b7561622b5241704563517a53305250484e33546f5754794456786977396661634b2b6f7a694453686f363250584f5379456d314c5a365a352b7053516c364c666a596d324354755a6242315564764a3735757a5567394e362f65394d624b347a34344d6275305a533233554a6b74316a37304c6f456d45417054664a6a6142443036464e575935633474356359544d65706c2b46737a66374a44454168434a51795073434c6171686e303830384e383243584442326d2f397a7336676a72487551764c3367596d39572b75786248495344307031735849514e4b3730413d3d227d7d0000000000",
		},
		{
			name: "it should decode normarl with limit order successfully",
			data: "0xe21fd0e9000000000000000000000000000000000000000000000000000000000000002000000000000000000000000031008fab12f3435244fce4b332380c11ed6797b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000001ec000000000000000000000000000000000000000000000000000000000000021000000000000000000000000000000000000000000000000000000000000001e00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000001c954e8fe737f99f68fa1ccda3e51ebdb291948c0000000000000000000000002791bca1f2de4661ed88a30c99a7a9449aa841740000000000000000000000000000000000000000000000000000000000a3f2ea00000000000000000000000048397e166c78aaf801ab0641b2a9ab62f1d3892a0000000000000000000000000000000000000000000000000000000063edab930000000000000000000000000000000000000000000000000000000000001dc0000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000403a32adab000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000003c2e9227a6d3779e5b469e425caa7067b40ff1240000000000000000000000002791bca1f2de4661ed88a30c99a7a9449aa841740000000000000000000000001c954e8fe737f99f68fa1ccda3e51ebdb291948c000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000018c0000000000000000000000000000000000000000000000000a7ebd5e4363a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000008400000000000000000000000000000000000000000000000000000000000001020000000000000000000000000000000005a0a4f61745044a289ba4d9199d02acf0000000000000000000000002791bca1f2de4661ed88a30c99a7a9449aa841740000000000000000000000001c954e8fe737f99f68fa1ccda3e51ebdb291948c0000000000000000000000009d49033a19238f9fb6e8229eaa913c48b67589980000000000000000000000009d49033a19238f9fb6e8229eaa913c48b6758998000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004c4b400000000000000000000000000000000000000000000000004e454e1e3534000000000000000000000000000000000000000000000000000000000000000001e00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000000000000000000000000000000000000002e000000000000000000000000000000000000000000000000000000000000003a000000000000000000000000000000000000000000000000000000000000007a000000000000000000000000000000000000000000000000000000000000007c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000886634613231356333303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303463346234303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303465343534653165333533343030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000883239363633376266303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303463346234303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303465343534653165333533343030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003c839363164356231653030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030343030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030306130303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030323030303030303030303030303030303030303030303030303363326539323237613664333737396535623436396534323563616137303637623430666631323430303030303030303030303030303030303030303030303033633265393232376136643337373965356234363965343235636161373036376234306666313234303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030323030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030343030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030306330303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303034346366366663366533303030303030303030303030303030303030303030303030396434393033336131393233386639666236653832323965616139313363343862363735383939383030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030323436333539326332623030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030363365646563343430303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000310d0e75173440db81f5551c018025e70000000000000000000000002791bca1f2de4661ed88a30c99a7a9449aa841740000000000000000000000001c954e8fe737f99f68fa1ccda3e51ebdb291948c0000000000000000000000009d49033a19238f9fb6e8229eaa913c48b67589980000000000000000000000009d49033a19238f9fb6e8229eaa913c48b6758998000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004c4b400000000000000000000000000000000000000000000000004fcc1a89027f000000000000000000000000000000000000000000000000000000000000000001e00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000000000000000000000000000000000000002e000000000000000000000000000000000000000000000000000000000000003a000000000000000000000000000000000000000000000000000000000000007a000000000000000000000000000000000000000000000000000000000000007c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000886634613231356333303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303463346234303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303466636331613839303237663030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000883239363633376266303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303463346234303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303466636331613839303237663030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003c839363164356231653030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030343030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030306130303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030323030303030303030303030303030303030303030303030303363326539323237613664333737396535623436396534323563616137303637623430666631323430303030303030303030303030303030303030303030303033633265393232376136643337373965356234363965343235636161373036376234306666313234303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030323030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030343030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030306330303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303034346366366663366533303030303030303030303030303030303030303030303030396434393033336131393233386639666236653832323965616139313363343862363735383939383030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030323436333539326332623030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030363365646563376530303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c3032b1026c94204b364a1695ea18c9a0000000000000000000000002791bca1f2de4661ed88a30c99a7a9449aa841740000000000000000000000001c954e8fe737f99f68fa1ccda3e51ebdb291948c0000000000000000000000009d49033a19238f9fb6e8229eaa913c48b67589980000000000000000000000009d49033a19238f9fb6e8229eaa913c48b6758998000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000d002000000000000000000000000000000000000000000000000009da6d3cfe87000000000000000000000000000000000000000000000000000000000000000001e00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000000000000000000000000000000000000002e000000000000000000000000000000000000000000000000000000000000003a000000000000000000000000000000000000000000000000000000000000007a000000000000000000000000000000000000000000000000000000000000007c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000886634613231356333303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303661636663303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303734393263623765623134383030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000883239363633376266303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303661636663303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303734393263623765623134383030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003c839363164356231653030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030343030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030306130303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030323030303030303030303030303030303030303030303030303363326539323237613664333737396535623436396534323563616137303637623430666631323430303030303030303030303030303030303030303030303033633265393232376136643337373965356234363965343235636161373036376234306666313234303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030323030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030343030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030306330303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303034346366366663366533303030303030303030303030303030303030303030303030396434393033336131393233386639666236653832323965616139313363343862363735383939383030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030323436333539326332623030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030363365646563356230303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000001e000000000000000000000000000000000000000000000000000000000000000826134633936393763656431353731653634373137626537333965623031616536643830303730366438633039346466343661386536633432306138663832663932346331653566636364336562383034353435373639636565386365373939643138366163353439653730666537313737386637303334653138326566373731316200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000826462333965653430343732633035363561333436393837323866346434663264616638613434366437313332663838396430663836316239363136343762666333366262363236346339303436376633376365363630336261353465333364393834626263373633333832643739643565653334666230653039363037306632316300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000823333393661623734643231353632376438303666303735313435623166326634336564643035326165383732393833386162356463623333316430326232393735626130323562366663376532623237666364386462656333353635323063383432343136613338633733366262616233623837306136396634323633386431316300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001c954e8fe737f99f68fa1ccda3e51ebdb291948c0000000000000000000000002791bca1f2de4661ed88a30c99a7a9449aa84174000000000000000000000000000000000000000000000000000000000000016000000000000000000000000000000000000000000000000000000000000001a000000000000000000000000000000000000000000000000000000000000001e000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a7ebd5e4363a00000000000000000000000000000000000000000000000000000000000000a3f2ea00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000220000000000000000000000000000000000000000000000000000000000000000100000000000000000000000031008fab12f3435244fce4b332380c11ed6797b00000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000a7ebd5e4363a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006d7b22536f75726365223a22222c22416d6f756e74496e555344223a2231302e34373636323737222c22416d6f756e744f7574555344223a2231302e383532222c22526566657272616c223a22222c22466c616773223a332c22496e74656772697479496e666f223a6e756c6c7d00000000000000000000000000000000000000",
		},
	}

	for _, tc := range testCases {
		t.Run(tc.name, func(t *testing.T) {
			decoder := Decoder{}

			result, err := decoder.Decode(tc.data)

			assert.Nil(t, err)

			str, _ := json.MarshalIndent(result, "", "\t")

			fmt.Println(string(str))
		})
	}
}
