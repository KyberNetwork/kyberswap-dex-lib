env: "production"
pprof: false
http:
  bindAddress: ":8080"
  mode: release #(debug,release,test)
  prefix: /ethereum
grpc:
  host: 0.0.0.0
  port: 10443
common:
  chainId: &chainId 1
  chainName: &chainName ethereum
  rpc: "https://ethereum.kyberengineering.io"
  multicallAddress: "0xcA11bde05977b3631167028862bE2a173976CA11"
  executorAddress: &executorAddress "0xd1B47490209CcB7A806E8a45d9479490C040ABf4"
  routerAddress: &routerAddress "0x6131B5fae19EA4f9D964eAc0408E4408b66337b5"
  gasTokenAddress: &gasTokenAddress "0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2"
  whitelistedTokenSet: &whitelistedTokenSet
    0xb50721bcf8d664c30412cfbc6cf7a15145234ad1: true # ARB
    0x1a7e4e63778b4f12a199c062f3efdd288afcbce8: true # agEUR
    0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2: true # WETH
    0xdac17f958d2ee523a2206206994597c13d831ec7: true # USDT
    0x6b175474e89094c44da98b954eedeac495271d0f: true # DAI
    0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48: true # USDC
    0x2260fac5e5542a773aa44fbcfedf7c193bc2c599: true # WBTC
    0xdefa4e8a7bcba345f687a2f1456f5edd9ce97202: true # KNC
    0x7f39c581f595b53c5cb19bd0b3f8da6c935e2ca0: true # wstETH
    0xae7ab96520de3a18e5e111b5eaab095312d7fe84: true # stETH
  blacklistedPoolSet: &blacklistedPoolSet
    0x3dabc75ffd70695852da101b0c0d018781320551: true
    0xf6a8e47daeeddcce297e7541523e27df2f167bf3: true
  availableSources: &availableSources
    - "kyberswap"
    - "kyberswap-static"
    - "kyberswap-elastic"
    - "uniswap"
    - "uniswapv3"
    - "sushiswap"
    - "curve"
    - "curve-stable-plain"
    - "synapse"
    - "shibaswap"
    - "defiswap"
    - "saddle"
    - "dodo-classical"
    - "dodo-dpp"
    - "dodo-dsp"
    - "dodo-dvm"
    - "maker-psm"
    - "lido"
    - "fraxswap"
    - "kyberswap-limit-order"
    - "verse"
    - "maverick-v1"
    - "pancake"
    - "pancake-v3"
    - "sushiswap-v3"
    - "wombat"
    - "kyber-pmm"
    - "crowdswap-v2"
    - "pol-matic"
    - "traderjoe-v21"
    - "smardex"
    - "balancer-v1"
    - "balancer-v2-weighted"
    - "balancer-v2-stable"
    - "balancer-v2-composable-stable"
    - "solidly-v3"
    - "wagmi"
    - "gyroscope-2clp"
    - "gyroscope-3clp"
    - "gyroscope-eclp"
    - "blueprint"
    - "swaap-v2"
    - "bancor-v3"
    - "etherfi-eeth"
    - "etherfi-weeth"
    - "kelp-rseth"
    - "rocketpool-reth"
    - "ethena-susde"
    - "maker-savingsdai"
    - "hashflow-v3"
    - "bancor-v21"
    - "native-v1"
    - "renzo-ezeth"
    - "bedrock-unieth"
    - "puffer-pufeth"
    - "swell-rsweth"
    - "swell-sweth"
  featureFlags: &featureFlags
  swaapAPIKey:
  hashflowAPIKey:
  nativeAPIKey:
log:
  sentryDSN: "https://6cd398671bde455f8fadad6dbfe87a67@sentry-v2.knstats.com/48"
  consoleLevel: info
  enableConsole: true
  enableJSONFormat: true
redis:
  addresses:
  masterName: ""
  dbNumber: 0
  password: ""
  prefix: *chainName
  readTimeout: 3s
  writeTimeout: 3s
  readOnly: false
  routeRandomly: false
pregenRedis:
  addresses:
  masterName: ""
  dbNumber: 0
  password: ""
  prefix: *chainName
  readTimeout: 3s
  writeTimeout: 3s
  readOnly: false
  routeRandomly: false
poolRedis:
  addresses:
  masterName: ""
  dbNumber: 0
  password: ""
  prefix: *chainName
  readTimeout: 3s
  writeTimeout: 3s
  readOnly: false
  routeRandomly: false
poolEventRedis:
  addresses:
  masterName: ""
  dbNumber: 0
  password: ""
  prefix: *chainName
  readTimeout: 3s
  writeTimeout: 3s
  readOnly: false
  routeRandomly: false
ddAgentHost: ""
keyPair:
  storageFilePath: ""
  keyIDForSealingData:
    clientData: "1"
reloadConfig:
  httpUrl: ""
  interval: 10s
  serviceName: "aggregator"
  chainID: *chainId
secretKey:
metrics:
  host:
  port: 8125
  namespace: "kybernetwork."
encoder:
  chainId: *chainId
  executorAddress: *executorAddress
  routerAddress: *routerAddress
  isPositiveSlippageEnabled: true
  minimumPSThreshold: 1000000
  executorAddressByClientID:
    unibot-tg: 0x1BC5cF80f308518f000dDE4c8f8139268aA014DB
    defillama: *executorAddress
  partnerPositiveSlippageInfo:
    defillama:
      receiver:
      percent:
      feeMode:
      feeSharingAddress:
useCase:
  getRoute:
    chainId: *chainId
    gasTokenAddress: *gasTokenAddress
    routerAddress: *routerAddress
    availableSources: *availableSources
    aggregator:
      whitelistedTokenSet: *whitelistedTokenSet
      getBestPoolsOptions: &getBestPoolsOptions
        directPoolsCount: 100
        whitelistPoolsCount: 500
        tokenInPoolsCount: 200
        tokenOutPoolCount: 200
        amplifiedTvlDirectPoolsCount: 50
        amplifiedTvlWhitelistPoolsCount: 200
        amplifiedTvlTokenInPoolsCount: 100
        amplifiedTvlTokenOutPoolCount: 100
      finderOptions: &finderOptions
        type: retry
        maxHops: 3
        distributionPercent: 5
        maxPathsInRoute: 20
        maxPathsToGenerate: 5
        maxPathsToReturn: 200
        minPartUSD: 500
        minThresholdAmountInUSD: 0
        maxThresholdAmountInUSD: 100000000
        isHillClimbEnabled: false
        hillClimbDistributionPercent: 1
        hillClimbIteration: 2
        hillClimbMinPartUSD: 500
        isPathGeneratorEnabled: false
        useAEVMRemoteFinder: false
        remoteUseAEVMPool: false
        localUseAEVMPool: false
    cache:
      defaultTtl: 15s
      ttlByAmount:
        - amount: 1
          ttl: 30s
        - amount: 2
          ttl: 10s
        - amount: 5
          ttl: 10s
        - amount: 10
          ttl: 10s
        - amount: 11
          ttl: 30s
        - amount: 15
          ttl: 10s
        - amount: 20
          ttl: 10s
        - amount: 22
          ttl: 30s
        - amount: 25
          ttl: 10s
        - amount: 30
          ttl: 10s
        - amount: 33
          ttl: 30s
        - amount: 35
          ttl: 10s
        - amount: 40
          ttl: 10s
        - amount: 44
          ttl: 30s
        - amount: 45
          ttl: 10s
        - amount: 50
          ttl: 10s
        - amount: 55
          ttl: 30s
        - amount: 60
          ttl: 10s
        - amount: 66
          ttl: 30s
        - amount: 70
          ttl: 10s
        - amount: 77
          ttl: 30s
        - amount: 80
          ttl: 10s
        - amount: 88
          ttl: 30s
        - amount: 90
          ttl: 10s
        - amount: 99
          ttl: 30s
        - amount: 100
          ttl: 10s
        - amount: 500
          ttl: 10s
        - amount: 1000
          ttl: 10s
        - amount: 10000
          ttl: 10s
        - amount: 100000
          ttl: 10s
      ttlByAmountUsdRange:
        - amountUSDLowerBound: 0
          ttl: 10s
        - amountUSDLowerBound: 5
          ttl: 10s
        - amountUSDLowerBound: 21
          ttl: 10s
        - amountUSDLowerBound: 101
          ttl: 10s
        - amountUSDLowerBound: 500
          ttl: 10s
        - amountUSDLowerBound: 1001
          ttl: 10s
        - amountUSDLowerBound: 2000
          ttl: 10s
        - amountUSDLowerBound: 5000
          ttl: 10s
        - amountUSDLowerBound: 10000
          ttl: 10s
      ttlByAmountRange:
        - amountLowerBound: "0"
          ttl: 10s
      priceImpactThreshold: 0.005
      shrinkFuncName: "decimal"
      shrinkDecimalBase: 8
      shrinkFuncPowExp: 0.7
      shrinkFuncLogPercent: 1.01
      enableNewCacheKeyGenerator: false
      shrinkAmountInConfigs:
        - shrinkFuncName: "logarithm"
          shrinkFuncConstant: 1.3
        - shrinkFuncName: "logarithm"
          shrinkFuncConstant: 1.5
        - shrinkFuncName: "logarithm"
          shrinkFuncConstant: 1.8
      shrinkAmountInThreshold: 100000
      minAmountInUSD: 0.9
    safetyQuoteConfig:
      excludeOneSwapEnable: true
      factor:
        StrictlyStable: 0
        Stable: 0.5
      whitelistedClient:
  buildRoute:
    chainId: *chainId
    rfq:
      - id: kyber-pmm
        handler: kyber-pmm
        properties:
          http:
            base_url: "https://kyberswap.knreserve.com"
            timeout: 10s
            retry_count: 3
          rfq_contract_address: "0x7A819Fa46734a49D0112796f9377E024c350FB26"
      - id: kyberswap-limit-order-v2
        handler: limit-order
        properties:
          chainID: *chainId
          limitOrderHTTPUrl: http://limit-order.pre-release-cluster.gke.production.internal
      - id: swaap-v2
        handler: swaap-v2
        properties:
          http:
            base_url: "https://api.swaap.finance"
            timeout: 10s
            retry_count: 3
      - id: hashflow-v3
        handler: hashflow-v3
        properties:
          http:
            base_url: "https://api.hashflow.com"
            source: kyber
            timeout: 3s
            retry_count: 3
      - id: native-v1
        handler: native-v1
        properties:
          http:
            base_url: "https://newapi.native.org"
            timeout: 10s
            retry_count: 3
    faultyPools:
      minSlippageThreshold: 1000
      whitelistedTokenSet: *whitelistedTokenSet
  poolFactory:
    chainId: *chainId
    useAEVM: &useAEVM false
    dexUseAEVM:
      uniswap: false
      uniswapv3: false
      liquiditybook-v20: false
      liquiditybook-v21: false
      ambient: true
    addressesByDex:
      uniswap:
        router-address: 0x7a250d5630b4cf539739df2c5dacb4c659f2488d
      uniswapv3:
        router-address: 0xe592427a0aece92de3edee1f18e0157c05861564
  poolManager:
    blacklistedPoolSet: *blacklistedPoolSet
    blackListRenewalInterval: 30s
    capacity: 1000000
    poolRenewalInterval: 12s
    useAEVM: *useAEVM
    faultyPoolsExpireThreshold: 3s
    stallingPMMThreshold: 30s
  indexPools:
    whitelistedTokenSet: *whitelistedTokenSet
    chunkSize: 3000
    maxGoroutines: 0
    enableRankByNative: false
  generateBestPaths:
    gasTokenAddress: *gasTokenAddress
    getBestPoolsOptions: *getBestPoolsOptions
    spfaFinderOptions: *finderOptions
    whitelistedTokens: *whitelistedTokenSet
    availableSources: *availableSources
    blacklistedPools:
    configGeneratorDataTtl: 12h
    pathGeneratorDataTtl: 2h
    maintainingInterval: 360s
    chainId: *chainId
  trackExecutor:
    subgraphURL: https://api.thegraph.com/subgraphs/name/kybernetwork/kyberswap-aggregator-ethereum
job:
  indexPools:
    forceScanAllEveryNth: 10
    interval: 2s
    poolEvent:
      consumerConfig:
        prefix: *chainName
        stream: "pool_events"
        group: "router_indexPools"
        key: "message"
        block: 300ms
        count: 100
        bufferSize: 20
        ackBufferSize: 10
      batchRate: 700ms
      batchSize: 100
      retryInterval: 5s
  updateSuggestedGasPrice:
    interval: 15s
  trackExecutorBalance:
    interval: 1h
  generateBestPaths:
    interval: 360s
repository:
  gas:
    redis:
      prefix: *chainName
    ristretto:
      numCounters: 5000
      maxCost: 500
      bufferItems: 64
      suggestedGasPrice:
        cost: 1
        ttl: 15s
  pool:
    redis:
      prefix: *chainName
      maxFaultyPoolSize: 500
    ristretto:
      numCounters: 5000
      maxCost: 500
      bufferItems: 64
      faultyPools:
        cost: 1
        ttl: 5s
  price:
    redis:
      prefix: *chainName
    ristretto: &pricecache
      numCounters: 10000
      maxCost: 1000
      bufferItems: 64
      price:
        cost: 1
        ttl: 1m
  onchainprice:
    enabled: false
    grpc:
      base_url: onchain-price.core-cluster.gke.production.internal:80
      timeout: 300ms
      insecure: true
      client_id: router-service
    ristretto: *pricecache
  poolService:
    baseUrl: "0.0.0.0:10443"
    insecure: true
    timeout: 100ms
    chainId: *chainId
  token:
    redis:
      prefix: *chainName
    goCache:
      expiration: -1
      cleanupInterval: -1
  poolRank:
    redis:
      prefix: *chainName
    useNativeRanking: false
  route:
    redis:
      prefix: *chainName
    ristretto:
      numCounters: 10000
      maxCost: 1000
      bufferItems: 64
      prefix: *chainName
      route:
        cost: 1
        ttl: 10s
  blackjack:
    grpcClient:
      baseURL: blackjack.core-cluster.gke.production.internal:80
      insecure: true
      timeout: 100ms
  erc20balanceslot:
    redis:
      prefix: *chainName
validator:
  slippageValidatorConfig:
    slippageToleranceGte: 0
    slippageToleranceLte: 5000
  buildRouteParams:
    blacklistedRecipientSet:
  getRouteEncodeParams:
    blacklistedRecipientSet:
aevmEnabled: false
aevm:
  serverUrl: "localhost:8246"
  publishingPoolsUrls:
  rpc: "http://localhost:8545"
  simulationWallet: "0x19767032471665df0fd7f6160381a103ece6261a"
  useHoldersListAsFallback: false
  tokenHoldersRedis:
    addresses:
    masterName: ""
    dbNumber: 0
    password: ""
    prefix: *chainName
    readTimeout: 3s
    writeTimeout: 3s
    readOnly: false
    routeRandomly: false
  cachedHoldersListTTLSec: 30
  predefinedBalanceSlots:
    # LIDO token
    0x5a98fcbea516cf06857215779fd812ca3bef1b32:
      token: 0x5a98fcbea516cf06857215779fd812ca3bef1b32
      wallet: 0x19767032471665df0fd7f6160381a103ece6261a
      found: true
      balanceSlot: 0x1d92366e0eb8047c54dfd3b4dbea0f8e23e5b021de7fe643c5e1b27c1a169cf0
      # the first 128 bits is balance = 0x0000ffffffffffffffffffffffffffff (which is large enough)
      # the last 128 bits is block number at which balance is changed
      preferredValue: 0x0000ffffffffffffffffffffffffffff000000000000000000000000010c766a
      extraOverrides:
        # balance history length, must be > 0
        0x5a7df2e997858d39f2aef4861e79c3133f8533d36ea28b6a66fa8b4914908a5a: 0x0000000000000000000000000000000000000000000000000000000000000001
